CREATE TABLE USUARIO
(
	ID_USUARIO           INTEGER NOT NULL ,
	NOME_USUARIO         VARCHAR2(20) NULL ,
	LOGIN_USUARIO        VARCHAR2(20) NULL ,
	SENHA_USUARIO        VARCHAR2(20) NULL ,
	BIO_USUARIO          VARCHAR2(80) NULL 
);

CREATE UNIQUE INDEX XPKUSUARIO ON USUARIO
(ID_USUARIO   ASC);

ALTER TABLE USUARIO
	ADD CONSTRAINT  XPKUSUARIO PRIMARY KEY (ID_USUARIO);

CREATE TABLE BLOG
(
	TITULO_BLOG          VARCHAR2(40) NULL ,
	ID_BLOG              INTEGER NOT NULL ,
	DESCRICAO_BLOG       VARCHAR2(60) NULL ,
	META                 VARCHAR2(20) NULL 
);

CREATE UNIQUE INDEX XPKBLOG ON BLOG
(ID_BLOG   ASC);

ALTER TABLE BLOG
	ADD CONSTRAINT  XPKBLOG PRIMARY KEY (ID_BLOG);

CREATE TABLE CATEGORIA
(
	IDCATEGORIA          INTEGER NOT NULL ,
	NOME_CATEGORIA       VARCHAR2(40) NULL ,
	DESCRICAO_CATEGORIA  CHAR(18) NULL 
);

CREATE UNIQUE INDEX XPKCATEGORIA ON CATEGORIA
(IDCATEGORIA   ASC);

ALTER TABLE CATEGORIA
	ADD CONSTRAINT  XPKCATEGORIA PRIMARY KEY (IDCATEGORIA);

CREATE TABLE POST
(
	ID_POST              INTEGER NOT NULL ,
	TITULO_POST          VARCHAR2(40) NULL ,
	DATACRIACAO_POST     DATE NULL ,
	CONTEUDO_POST        CLOB NULL ,
	IDCATEGORIA          INTEGER NULL ,
	ID_USUARIO           INTEGER NOT NULL ,
	ID_TAG               INTEGER NULL 
);

CREATE UNIQUE INDEX XPKPOST ON POST
(ID_POST   ASC,ID_USUARIO   ASC);

ALTER TABLE POST
	ADD CONSTRAINT  XPKPOST PRIMARY KEY (ID_POST,ID_USUARIO);

CREATE TABLE COMENTARIO
(
	ID_COMENTARIO        INTEGER NOT NULL ,
	DATACRIACAO_COMENTARIO DATE NULL ,
	CONTEUDO_COMENTARIO  CLOB NULL ,
	ID_POST              INTEGER NOT NULL ,
	ID_USUARIO           INTEGER NOT NULL 
);

CREATE UNIQUE INDEX XPKCOMENTARIO ON COMENTARIO
(ID_COMENTARIO   ASC,ID_POST   ASC,ID_USUARIO   ASC);

ALTER TABLE COMENTARIO
	ADD CONSTRAINT  XPKCOMENTARIO PRIMARY KEY (ID_COMENTARIO,ID_POST,ID_USUARIO);

CREATE TABLE SESSAO
(
	ID_USUARIO           INTEGER NOT NULL ,
	ID_BLOG              INTEGER NOT NULL ,
	DATA_SESSAO          DATE NULL 
);

CREATE UNIQUE INDEX XPKUSUARIO_BLOG ON SESSAO
(ID_USUARIO   ASC,ID_BLOG   ASC);

ALTER TABLE SESSAO
	ADD CONSTRAINT  XPKUSUARIO_BLOG PRIMARY KEY (ID_USUARIO,ID_BLOG);

CREATE TABLE TAG
(
	ID_TAG               INTEGER NOT NULL ,
	NOME_TAG             VARCHAR2(20) NULL ,
	DESCRICAO_TAG        VARCHAR2(50) NULL 
);

CREATE UNIQUE INDEX XPKTAG ON TAG
(ID_TAG   ASC);

ALTER TABLE TAG
	ADD CONSTRAINT  XPKTAG PRIMARY KEY (ID_TAG);

ALTER TABLE POST
	ADD (CONSTRAINT post_categoria FOREIGN KEY (IDCATEGORIA) REFERENCES CATEGORIA (IDCATEGORIA) ON DELETE SET NULL);

ALTER TABLE POST
	ADD (CONSTRAINT post_usuario FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO (ID_USUARIO));

ALTER TABLE POST
	ADD (CONSTRAINT post_tag FOREIGN KEY (ID_TAG) REFERENCES TAG (ID_TAG) ON DELETE SET NULL);

ALTER TABLE COMENTARIO
	ADD (CONSTRAINT comentario_post FOREIGN KEY (ID_POST, ID_USUARIO) REFERENCES POST (ID_POST, ID_USUARIO));

ALTER TABLE SESSAO
	ADD (CONSTRAINT sessao_usario FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO (ID_USUARIO));

ALTER TABLE SESSAO
	ADD (CONSTRAINT sessao_blog FOREIGN KEY (ID_BLOG) REFERENCES BLOG (ID_BLOG));
